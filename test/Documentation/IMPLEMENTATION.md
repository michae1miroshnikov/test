# Детальне пояснення реалізації

## Архітектурні рішення

### 1. MVVM з SwiftUI
Використовується архітектура MVVM (Model-View-ViewModel) з SwiftUI:
- **Model**: `DeviceData`, `ServerResponse` - структури даних
- **View**: `ContentView` - інтерфейс користувача
- **ViewModel**: `DataCollector`, `BackgroundTaskManager` - бізнес-логіка

### 2. Singleton для мережевої взаємодії
`NetworkManager` реалізований як singleton для:
- Централізованого управління мережевими запитами
- Уникнення конфліктів при одночасних запитах
- Ефективного використання ресурсів

### 3. ObservableObject для реактивності
Всі ViewModel класи наслідують `ObservableObject` для:
- Автоматичного оновлення UI при зміні даних
- Реактивного зв'язку між моделлю та представленням
- Ефективного управління життєвим циклом

## Ключові компоненти

### DataCollector.swift
```swift
class DataCollector: ObservableObject {
    @Published var currentBatteryLevel: Float = 0.0
    @Published var isMonitoring = false
    
    private var timer: Timer?
}
```

**Функціональність:**
- Моніторинг рівня батареї через `UIDevice.current.batteryLevel`
- Таймер для збору даних кожні 2 хвилини (120 секунд)
- Автоматичне управління життєвим циклом

**Оптимізація:**
- Використання `weak self` в замиканнях для уникнення retain cycles
- Автоматичне вимкнення моніторингу батареї в `deinit`

### NetworkManager.swift
```swift
class NetworkManager {
    static let shared = NetworkManager()
    private let baseURL = "https://jsonplaceholder.typicode.com/posts"
}
```

**Безпека:**
- HTTPS з'єднання з валідацією сертифікатів
- Кодування JSON даних у Base64 для базового захисту
- Валідація відповідей сервера

**Структура payload:**
```json
{
  "data": "base64_encoded_json_data",
  "type": "device_data"
}
```

### BackgroundTaskManager.swift
```swift
class BackgroundTaskManager: ObservableObject {
    private var backgroundTaskID: UIBackgroundTaskIdentifier = .invalid
}
```

**Фонова робота:**
- Використання `UIBackgroundTask` для продовження роботи у фоні
- Автоматичне управління життєвим циклом задач
- Перевірка доступного часу фонової роботи

## Оптимізація ресурсів

### 1. Мінімальне споживання батареї
- Таймер з інтервалом 2 хвилини (не занадто часто)
- Автоматичне вимкнення моніторингу при завершенні
- Ефективне управління мережевими запитами

### 2. Управління пам'яттю
- Використання `weak` посилань
- Правильне завершення таймерів
- Автоматичне звільнення ресурсів

### 3. Мережева оптимізація
- Асинхронні запити без блокування UI
- Обробка помилок мережі
- Retry логіка (можна додати)

## Безпека даних

### 1. HTTPS з'єднання
- Примусове використання TLS 1.2+
- Валідація сертифікатів сервера
- Налаштування в Info.plist

### 2. Кодування даних
```swift
// Кодування JSON у Base64
let base64Data = jsonData.base64EncodedString()
```

### 3. Валідація відповідей
- Перевірка HTTP статус кодів
- Декодування відповідей сервера
- Обробка помилок мережі

## Тестування

### 1. На симуляторі
- Перевірка збору даних
- Тестування UI інтерфейсу
- Валідація мережевих запитів

### 2. На реальному пристрої
- Тестування фонового режиму
- Перевірка споживання батареї
- Валідація роботи з реальними даними

### 3. Фоновий режим
- Переключення між додатками
- Натискання кнопки Home
- Перевірка продовження роботи

## Логування та діагностика

### Консольні повідомлення:
-  Зібрано дані про батарею
-  Успішна відправка на сервер
-  Помилки мережі
-  Статус фонових задач

### Відстеження в Xcode:
- Використання Debug Navigator
- Моніторинг використання пам'яті
- Перевірка мережевої активності


### Структура для розширення:
```swift
protocol DataCollectable {
    func collectData() -> DeviceData
}

protocol NetworkSendable {
    func sendData(_ data: DeviceData, completion: @escaping (Result<ServerResponse, Error>) -> Void)
}
```

## Висновок

Модуль реалізований з дотриманням всіх технічних вимог:
- ✅ Swift та iOS 15+
- ✅ Структурований код (MVVM)
- ✅ Збір даних про батарею кожні 2 хвилини
- ✅ HTTPS відправка на сервер
- ✅ Базовий захист даних (Base64)
- ✅ Оптимізація ресурсів
- ✅ UIBackgroundTask для фонової роботи
- ✅ Детальні коментарі в коді

Модуль готовий до використання та подальшого розвитку. 
